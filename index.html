<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Fraunces:ital,opsz,wght@0,9..144,100..900;1,9..144,100..900&family=Spline+Sans:wght@300..700&display=swap"
    rel="stylesheet">
  <title>Vite App</title>
</head>

<body>

  <!--Start screen-->
  <div id="start-screen" class="screen screen--start active">
    <section class="screen--start__left">
      <h1 class="title">Memory Leak</h1>
      <p class="description">The only place you're allowed to leak memory.</p>
      <button type="button" class="start-btn button">Get started</button>
    </section>
    <section class="screen--start__right">
      <div class="leaderboard"></div>
    </section>

    <!--LEAVE BUTTON-->
    </section>

  </div>


  <!--User screen-->
  <div id="user-info-screen" class="screen hidden">
    <H3>ENTER YOUR DETAILS</H3>
    <form id="user-details">
      <label for="username">Username</label>
      <input type="text" name="userName" id="userName" required>

      <label for="tech-category">Category</label>
      <select id="tech-category" name="tech-category" required>
        <option value="general_it" selected>General IT</option>
        <option value="database_management_systems">Database Management Systems</option>
        <option value="css">css</option>
        <option value="computer_hardware">Computer Hardware</option>
      </select>

      <input type="button" class="submit-user-info" value="submit">
    </form>
  </div>



  <!--Quiz screen-->
  <div id="quiz-screen" class="screen hidden">
    <header class="screen__header"></header>
    <section class="screen__question"></section>
  </div>

  <!--Highscore screen-->
  <div id="highscore-screen" class="screen hidden">
    <!-- Start screen content: user enters name, selects categories -->
  </div>
  <div class="table-rank" id="leaderboard">
    <div class="table-header">
      <h1>Leaderboard</h1>
      <h4>Choose Category</h4>
      <select>
        <option>All Rankings</option>
        <option>HTML</option>
        <option>CSS</option>
        <option>Javascript</option>
        <option>Gaming and computers</option>
      </select>
    </div>
    <div class="table-body">
      <table>
        <thead>
          <tr>
            <th>Position</th>
            <th>Player Name</th>
            <th>Points</th>
          </tr>
        </thead>
        <tbody id="leaderboard-body"></tbody>
      </table>
    </div>
  </div>

  <script type="module" src="/src/main.js">
    /* Function to select high scores according to category */
    function selectByCategory(players, category) {
      if (category === "All Rankings") {
        return players;
      }
      return players.filter(
        (player) => player.category.toLowerCase() === category.toLowerCase()
          || (category === "Javascript" && player.category === "JS") ||
          (category === "Gaming and computers" && player.category === "Gaming")
      );
    }
    /* function to insert the data from local storage to UI of the leaderboard */
    function insertsDataOnBoard(players) {
      leaderBoardEl.innerHTML = "";

      players.forEach((player, i) => {
        const tableRow = document.createElement("tr");
        tableRow.innerHTML = `
        <td>${i + 1}</td>
        <td>${player.name}</td>
        <td>${player.score}</td>`;
        leaderBoardEl.appendChild(tableRow);
      });
    }

    const sortedPlayers = dbPlayers.sort((x, y) => y.score - x.score);


    insertsDataOnBoard(sortedPlayers);
    categoryEl.addEventListener("change", (e) => {
      const selectedCategory = e.target.value;
      const filteredPlayers = selectByCategory(sortedPlayers, selectedCategory);
      insertsDataOnBoard(filteredPlayers);
    });
  </script>
</body>

</html>
